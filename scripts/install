#!/bin/sh
set -euo pipefail

# Install Abra cli to Cargo bin
cargo install --bin abra --path cli

# Install Vim syntax highlighting if ~/.vim exists
VIM_DIR="$HOME/.vim"
TARGET_DIR="$VIM_DIR/syntax"
SOURCE_FILE="./tooling/abra.vim"
TARGET_FILE="$TARGET_DIR/abra.vim"
if [ -d "$VIM_DIR" ]; then
  mkdir -p $VIM_DIR/syntax
  mkdir -p $VIM_DIR/ftdetect
  cp ./tooling/vim/syntax.vim $VIM_DIR/syntax/abra.vim
  cp ./tooling/vim/ftdetect.vim $VIM_DIR/ftdetect/abra.vim
fi

# Install Vscode highlighting extension
npm install -g @vscode/vsce
git clone git@github.com:anandrav/abra-syntax.git
pushd abra-syntax
vsce package --allow-missing-repository
code --install-extension abra-0.0.1.vsix
popd
rm -rf abra-syntax
