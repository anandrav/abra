<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Abra Programming Language</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "ayu";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Abra Programming Language</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/anandrav/abra" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="about-abra"><a class="header" href="#about-abra">About Abra</a></h1>
<p>Abra aims to be the most <strong>user-friendly</strong> programming language.</p>
<p>More specifically, Abra is optimized for these use cases:</p>
<ol>
<li>Giving beginners a gentle introduction to programming</li>
<li>Allowing experienced programmers to prototype quickly</li>
</ol>
<p>Some noteworthy features that support these use cases include:</p>
<h3 id="hindley-milner-type-system"><a class="header" href="#hindley-milner-type-system">Hindley-Milner Type System</a></h3>
<p>Abra is a statically-typed language with Hindley-Milner type inference. Types help programmers avoid bugs by catching errors at compile time. At the same time, type inference saves programmers time by removing the need for type annotations everywhere.</p>
<h3 id="garbage-collection"><a class="header" href="#garbage-collection">Garbage Collection</a></h3>
<p>Abra is garbage-collected, so programmers don't have to manually manage memory themselves, and they can save brainpower for other aspects of their program instead.</p>
<h3 id="adhoc-polymorphism"><a class="header" href="#adhoc-polymorphism">Adhoc Polymorphism</a></h3>
<p>In addition, Abra has a concept of "interfaces" which is very similar to "traits" in Rust or "typeclasses" in Haskell. These enable programmers to use the '+' operator on both integers and floats, or print several kinds of datatypes without having to use separate functions for each (print() as opposed to print_string(), print_int(), print_float() etc.)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>To install Abra, download the repository from https://github.com/anandrav/abra.
Then, run the script located at /scripts/install</p>
<pre><code>git clone https://github.com/anandrav/abra
cd abra
./scripts/install
</code></pre>
<p>After, you should be able to run Abra from the command line</p>
<pre><code>% abra --help
Usage: abra [OPTIONS] &lt;FILE&gt; [ARGS]...

Arguments:
  &lt;FILE&gt;     The main Abra file to compile and execute
  [ARGS]...  Arguments to pass to the Abra program

Options:
  -m, --modules &lt;DIRECTORY&gt;  Override the default module directory (~/.abra/modules).
  -h, --help                 Print help
  -V, --version              Print version

</code></pre>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<h3 id="cargo"><a class="header" href="#cargo">Cargo</a></h3>
<p>Cargo, the Rust package manager, is required to run the install script. The best way to install Cargo is by using <a href="https://www.rust-lang.org/tools/install">rustup</a>.</p>
<h3 id="node"><a class="header" href="#node">Node</a></h3>
<p>If you're using Visual Studio Code and want to install the Abra extension, you'll want to <a href="https://nodejs.org/en/download/package-manager">install Node</a> as well before running the install script.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world"><a class="header" href="#hello-world">Hello World</a></h1>
<p>To make a simple hello world program, create a file called <code>hello.abra</code>.</p>
<p>Inside the file, write</p>
<pre><code>print("hello world")
</code></pre>
<p>Then run the file using the command <code>abra hello.abra</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="built-in-types"><a class="header" href="#built-in-types">Built-in Types</a></h1>
<h3 id="int"><a class="header" href="#int">int</a></h3>
<p>A 64-bit signed integer.
Supports addition, subtraction, multiplication, division, and exponentiation operators.</p>
<pre><code>let a = 5
let b = 2 + 2   // 4
let c = 2 * 3   // 6
let d = 5 - 2   // 3
let e = 12 / 3  // 4
let f = 13 / 3  // also 4
let g = 2 ^ 3   // 8

let n = (a + c / d) ^ 2 // 49
</code></pre>
<h3 id="float"><a class="header" href="#float">float</a></h3>
<p>A 64-bit signed floating point decimal number.
Supports addition, subtraction, multiplication, division, and exponentiation operators.</p>
<pre><code>let pi = 3.14159
let e = 2.71828
</code></pre>
<h3 id="boolean"><a class="header" href="#boolean">boolean</a></h3>
<pre><code>let shield_is_equipped = true
let sword_is_equipped = false
</code></pre>
<h3 id="string"><a class="header" href="#string">string</a></h3>
<p>Garbage-collected unicode text data.
Strings can be concatenated together using the <code>&amp;</code> operator.</p>
<pre><code>let name = "Merlin"
let message = name &amp; " is a wizard." // "Merlin is a wizard."
</code></pre>
<h3 id="arrayt"><a class="header" href="#arrayt">array&lt;'T&gt;</a></h3>
<p>A built-in dynamic array data structure. Supports random access (zero-indexed), pushing, and popping elements.
Arrays are homogenous; elements of the array must have the same type i.e. an array cannot mix <code>int</code> and <code>float</code>
elements, for instance.</p>
<pre><code>let arr = [1, 2, 3, 4]  // create an array with some numbers
arr.push(5)             // arr = [1, 2, 3, 4, 5]
let n = arr.len()       // 5
let n = arr[2]          // 3
arr[2] := 49
let n = arr[2]          // 49
arr.pop()               // arr = [1, 2, 3, 4]
</code></pre>
<h3 id="tuples"><a class="header" href="#tuples">tuples</a></h3>
<ul>
<li><code>('T, 'U)</code></li>
<li><code>('T, 'U, 'V)</code></li>
<li>and so on...</li>
</ul>
<p>A tuple is 2 or more values grouped together.
It is sometimes useful to group related values together.
For instance, a tuple of three floats could be used to represent a coordinate in 3d space.
Unlike arrays, tuples can have elements of different types.
Unlike arrays, tuples cannot have elements added or removed.</p>
<pre><code>let pair_of_ints = (1, 2)
let coordinate_3d = (1.0, 2.0, -3.0)
let name_and_age = ("Lancelot", 19)
</code></pre>
<h3 id="void"><a class="header" href="#void">void</a></h3>
<p>Represents nothing and only has one value -- <code>()</code>.
This is useful as a return type for functions that don't return anything.
This is sometimes referred to as the "unit type" in other languages because it has a single value.</p>
<h3 id="never"><a class="header" href="#never">never</a></h3>
<p>The never type has zero values.
This is useful as a return type for a function which should never return.
For instance, the built-in <code>panic()</code> function, used to terminate the program in the case of an unrecoverable error, does
not return a value.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="variables"><a class="header" href="#variables">Variables</a></h1>
<p>Variables can be created using the <code>let</code> keyword.</p>
<pre><code>let x = 5
let y = 8
</code></pre>
<p>Mutable variables can be created using the <code>var</code> keyword.
Their value can be updated using the assignment <code>:=</code> operator.</p>
<pre><code>var x = 5       // x = 5
x := 6          // x = 6
let y = x + x   // y = 12
</code></pre>
<p>Variables can be given type annotations. For convenience, they are often not required.</p>
<p>In some situations, type annotations are required, for instance when writing code with generic types, invoking member
functions, or accessing struct fields. They also help the compiler give more tailored error messages in case you make a
mistake.</p>
<pre><code>let x: int = 2
let y: float = 3.14
let p: (int, int) = (1, 2)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="control-flow"><a class="header" href="#control-flow">Control Flow</a></h1>
<h2 id="if-else"><a class="header" href="#if-else">If-Else</a></h2>
<p>If-else expressions are used to choose between two pieces of code.
A boolean expression is given as an input. If the boolean value is true, the first piece of code is executed. If the
boolean value is false, then the second piece of code is executed.</p>
<pre><code>// this code prints "hello"

let is_arriving = true
if is_arriving {
    println("hello")
} else {
    println("good bye")
}

</code></pre>
<p>If-else expressions can be chained in succession to check multiple conditions.</p>
<pre><code>// this code prints "good night"

let is_morning = false
let is_afternoon = false
if is_morning {
    println("good morning")
} else if is_afternoon {
    println("good afternoon")
} else {
    println("good night")
}
</code></pre>
<p>If-else expressions always return a value.</p>
<pre><code>let x = if true { 1 } else { 0 }    // x = 1
</code></pre>
<h2 id="match"><a class="header" href="#match">Match</a></h2>
<p>Match expressions test an expression against a set of patterns.
The first pattern that matches will have its corresponding</p>
<pre><code>let n = 2
let s = match n {
    0 -&gt; "zero"
    1 -&gt; "one"
    2 -&gt; "two"
    3 -&gt; "three"
    _ -&gt; "something else"
}
// s = "two"

</code></pre>
<h2 id="while-loops"><a class="header" href="#while-loops">While loops</a></h2>
<pre><code>// this code prints
// "hellohellohello"

var n = 3
while n &gt; 0 {
    print("hello")
    n := n - 1
}
</code></pre>
<h2 id="for-loops"><a class="header" href="#for-loops">For loops</a></h2>
<pre><code>// this code prints "15"

let arr = [1, 2, 3, 4, 5]
var sum = 0

for n in arr {
    sum := sum + n
}

println(sum)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="functions"><a class="header" href="#functions">Functions</a></h1>
<p>A function is a piece of code that takes zero or more inputs and has a single output.</p>
<pre><code>fn distance(x1: float, x2: float, x2: float, y2: float) -&gt; float {
    sqrt((x2 - x1) ^ 2 + (y2 - y1) ^ 2)
}
</code></pre>
<p>Functions can be recursive.</p>
<pre><code>fn fibonacci(n: int) -&gt; int {
    if n &lt;= 1 {
        n
    } else {
        fib(n-2) + fib(n-1)
    }
}
</code></pre>
<p>The last expression in the body of the function is the return value. You can also return early from a function.</p>
<pre><code>fn fibonacci(n: int) -&gt; int {
    if n &lt;= 1 {
        return n        // early return
    }
    fib(n-2) + fib(n-1) // last expression is return value
}
</code></pre>
<p>A function always returns the value of its body.
If the body of a function is a block of statements, then the last expression of the block is the return value of the
function.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="structs"><a class="header" href="#structs">Structs</a></h1>
<p>Define a <code>struct</code> to group together related pieces of data.</p>
<pre><code>type Person = {
    first_name: string,
    last_name: string,
    age: int,
}
</code></pre>
<p>Create an instance of a struct by calling its constructor, which is a function that shares the same name as the struct.</p>
<pre><code>let frank = Person("Frank", "Smith", 34)
</code></pre>
<p>Access the fields of a struct and modify them by using dot <code>.</code> syntax.</p>
<pre><code>let fullname = frank.first_name &amp; " " &amp; frank.last_name
// fullname = "Frank Smith"
frank.age := frank.age + 1
// age = 35
</code></pre>
<p>Structs can have generic type arguments.</p>
<pre><code>type Ref&lt;'T&gt; = {
    value: 'T
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="enums"><a class="header" href="#enums">Enums</a></h2>
<p>Enums are useful for modeling data as a set of possible variants.</p>
<pre><code>type Color =
  | Red
  | Blue
  | Green
</code></pre>
<p>Data can be associated with each variant of an enum</p>
<pre><code>type Shape =
    | Circle(float)
    | Rectangle(float, float)
    | Triangle(float, float)
    
let circle = Shape.Circle(5.0)
let rect = Shape.Rectangle(2.0, 4.0)
</code></pre>
<p>Match expressions are used to handle each possible case of an enum.</p>
<pre><code>let c = Shape.Circle(5.2)
let area = match c {
    .Circle(radius) -&gt; radius * radius * pi,
    .Rectangle(width, height) -&gt; width * height,
    .Triangle(width, height) -&gt; width * height * 0.5,
}
</code></pre>
<p>Enums can have generic type arguments.</p>
<pre><code>type option&lt;'T&gt; =
  | some('T)
  | none
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="member-functions"><a class="header" href="#member-functions">Member Functions</a></h2>
<p>For convenience, you can define member functions on both user-defined and built-in types.</p>
<pre><code>type Person = {
    first_name: string,
    last_name: string,
    age: int,
}

extend Person {
    fn fullname(self) -&gt; string {
        self.first_name &amp; self.last_name
    }
}

...

let p = Person("Arthur", "Pendragon", 15)
let name = p.fullname() // "Arthur Pendragon"
</code></pre>
<pre><code>extend array&lt;'T&gt; {
    fn len(self: array&lt;'T&gt;) -&gt; int {
        array_length(self)
    }

    fn push(self: array&lt;'T&gt;, x: 'T) -&gt; void {
        array_push(self, x)
    }

    fn pop(self: array&lt;'T&gt;) -&gt; void {
        array_pop(self)
    }
}

...

let arr = [0, 1, 2, 3, 4]
arr.push(5)
let l = arr.len() // 6
</code></pre>
<p>In the examples above, a member function is invoked on a variable using the dot <code>.</code> operator.
The variable is passed as the first argument to the member function.</p>
<p>Member functions can also be invoked on the type itself.
In that case, the first argument to the function is passed in the parentheses.</p>
<pre><code>let p = Person("Arthur", "Pendragon", 15)
let name = Person.fullname(p)

let arr = [1, 2, 3, 4]
array.push(arr)
let l = array.len(arr) // 6
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h1>
<p>An interface is a set of operations supported by some type named <code>self</code>.</p>
<p>A type implements an interface if it supports all its operations.
As an example, the <code>Num</code> interface supports the <code>add()</code>, <code>subtract()</code>, <code>multiply()</code>, and <code>divide()</code> operations.
The Number interface is implemented by both the <code>int</code> and <code>float</code> built-in types.</p>
<pre><code>// support conversion to string
interface ToString {
    fn str(x: self) -&gt; string
}

type Person = {
    first_name: string,
    last_name: string,
    age: int,
}

// support conversion to string for the Person type
impl ToString for Person {
    fn str(x: Person) -&gt; string {
        x.first_name &amp; " " &amp; x.last_name &amp; ", " x.age &amp; " years old."
    }
}

...

let p = Person("Arthur", "Pendragon", 15)
let s = p.str() // "Arthur Pendragon 15"

</code></pre>
<h3 id="standard-library-interfaces"><a class="header" href="#standard-library-interfaces">Standard library interfaces</a></h3>
<h4 id="tostring"><a class="header" href="#tostring">ToString</a></h4>
<p>The ToString interface allows you to convert some type to a string.
Any type which implements the ToString interface can be passed as an argument to the <code>&amp;</code> operator.</p>
<pre><code>let arr = [1, 2, 3]
let arr_str = arr.str()         // arr_str = "[1, 2, 3]"
let age = 23
let name = "John"
println(name &amp; " is " &amp; age)    // prints "John is 23"
</code></pre>
<h4 id="clone"><a class="header" href="#clone">Clone</a></h4>
<p>The clone interface allows you to create a deep copy of some data structure.
For instance, cloning an array allows you to manipulate its copy without manipulating the original.</p>
<pre><code>let arr = [1, 2, 3]
let arr2 = arr.clone()
arr2.pop()
arr2.pop()
arr2.pop()
// arr = [1, 2, 3] and arr = []
</code></pre>
<h4 id="equal"><a class="header" href="#equal">Equal</a></h4>
<p>The equal interface is used to compare values for equality.
Types which implement the Equal interface can be compared for equality using the <code>=</code> operator.</p>
<h4 id="num"><a class="header" href="#num">Num</a></h4>
<p>The Num interface is used for <code>int</code> and <code>float</code>.
Types which implement the Num interface can use the arithmetic operators.</p>
<h4 id="iterable"><a class="header" href="#iterable">Iterable</a></h4>
<p>The Iterable interface is implemented for container types in order to iterate through their values.
Types which implement the Iterable interface can be used in a for loop.</p>
<h4 id="iterable-1"><a class="header" href="#iterable-1">Iterable</a></h4>
<p>Types which implement the Iterable interface, such as <code>array&lt;'T&gt;</code>, have an associated type which implements
the Iterator interface. In the case of <code>array&lt;'T&gt;</code>, that type is <code>ArrayIterator&lt;'T&gt;</code></p>
<h3 id="associated-types"><a class="header" href="#associated-types">Associated types</a></h3>
<ul>
<li>TODO</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="namespaces"><a class="header" href="#namespaces">Namespaces</a></h1>
<p>Each Abra file has its own namespace. In order to use functions from another file, the <code>use</code> keyword must be used to bring them into scope.</p>
<p>cat.abra</p>
<pre><code>fn meow() -&gt; string {
    "nyan nyan nyan"
}
</code></pre>
<p>main.abra</p>
<pre><code>use cat

meow()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="foreign-functions"><a class="header" href="#foreign-functions">Foreign Functions</a></h1>
<p>Functions defined in Rust can be called from Abra. Foreign functions must be declared ahead of time, so that their types are known. The corresponding Rust function definitions use the Abra VM API to pop arguments from the stack and push a return value to the stack.</p>
<p>os.abra</p>
<pre><code>foreign fn fread(path: string) -&gt; string

foreign fn fwrite(path: string, contents: string) -&gt; string
</code></pre>
<p>os/src/lib.rs</p>
<pre><code>use abra_core::vm::Vm;
use std::fs;

#[no_mangle]
pub unsafe extern "C" fn fread(vm: *mut Vm) {
    let string_view = vm_view_string(vm);
    let path = string_view.to_owned();
    vm_pop(vm);

    let content = fs::read_to_string(path).expect("Unable to read from file");

    let string_view = StringView::from_string(&amp;content);
    vm_push_string(vm, string_view);
}

#[no_mangle]
pub unsafe extern "C" fn fwrite(vm: *mut Vm) {
    let string_view = vm_view_string(vm);
    let content = string_view.to_owned();
    vm_pop(vm);

    // TODO: make a macro for this called get_string!
    let string_view = vm_view_string(vm);
    let path = string_view.to_owned();
    vm_pop(vm);

    fs::write(path, content).expect("Unable to write to file");
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
